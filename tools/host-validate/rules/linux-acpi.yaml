#
# Define facts for interesting ACPI tables on the host
#

facts:
- name: cpu.acpi.dmar
  filter:
    all:
      expressions:
      - fact:
          name: cpu.family.x86
          value: "true"
      - fact:
          name: cpu.vendor.intel
          value: "true"
      - fact:
          name: os.kernel
          value: Linux
  value:
    access:
      check: exists
      path: /sys/firmware/acpi/tables/DMAR
- name: cpu.acpi.ivrs
  filter:
    all:
      expressions:
      - fact:
          name: cpu.family.x86
          value: "true"
      - fact:
          name: cpu.vendor.amd
          value: "true"
      - fact:
          name: os.kernel
          value: Linux
  value:
    access:
      check: exists
      path: /sys/firmware/acpi/tables/IVRS
